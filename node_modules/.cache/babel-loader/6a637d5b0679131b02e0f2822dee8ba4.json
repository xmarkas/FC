{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import MyGroupOrders from\"./MyGroupOrders\";import{Link}from\"react-router-dom\";var MyGroupBuys=/*#__PURE__*/function(_Component){_inherits(MyGroupBuys,_Component);var _super=_createSuper(MyGroupBuys);function MyGroupBuys(){var _this;_classCallCheck(this,MyGroupBuys);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={menuIndex:null,removeCheck:null,viewOrder:null,showBuyOptions:null,buyQuantity:0,spinner:false};_this.totalUnitsPurchased=function(dealId){var units=0;_this.props.data.Purchases.forEach(function(p){if(p.deal_id===dealId){units+=p.purchase_units;}});return units;};_this.seeOrder=function(order){_this.setState({viewOrder:order});};_this.showBuyOptions=function(index,buy){var order=_this.props.data.Purchases.find(function(obj){return obj.deal_id===buy.id&&obj.user_id===_this.props.userId;});_this.setState({showBuyOptions:_this.state.showBuyOptions===index?null:index,buyQuantity:order?order.purchase_units:0});};_this.userHasOrder=function(userId,dealId){// Look for existing order\nvar order=_this.props.data.Purchases.find(function(obj){return obj.deal_id===dealId&&obj.user_id===userId;});return order?order:false;};_this.closeOptions=function(){setTimeout(function(){_this.setState({showBuyOptions:null,menuIndex:null,spinner:false,removeCheck:null});},1500);};return _this;}_createClass(MyGroupBuys,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(React.Fragment,null,this.state.viewOrder&&/*#__PURE__*/React.createElement(MyGroupOrders,{data:this.props.data,Buy:this.state.viewOrder,seeOrder:this.seeOrder}),!this.state.viewOrder&&/*#__PURE__*/React.createElement(\"div\",{className:\"card bg-light\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header button-group\"},/*#__PURE__*/React.createElement(\"div\",null,\"Our Buys - Place Your Order Now!\"),/*#__PURE__*/React.createElement(Link,{to:\"/catalog\",className:\"btn btn-sm btn-primary\",style:{font:\"small-caption\",float:\"right\",height:\"fit-content\"}},\"catalog\")),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body p-0\",style:{overflowY:\"auto\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid\",id:\"group-list\"},/*#__PURE__*/React.createElement(\"ul\",{id:\"group-buys-list\",style:{listStyle:\"none\",padding:\"0\",fontSize:\"small\"}},this.props.data&&this.props.data.Buys.map(function(b,index){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"li\",{key:index,className:\"row group-buy-item\",style:{boxShadow:_this2.state.showBuyOptions===index?\"0px 4px 6px 1px rgba(0, 0, 0, 0.2)\":\"none\"},onClick:function onClick(){return _this2.showBuyOptions(index,b);}},/*#__PURE__*/React.createElement(\"div\",{className:\"col-2\"},/*#__PURE__*/React.createElement(\"img\",{className:\"seller-img\",src:\"./Uploads/Deal_Images/\"+b.image_url,alt:\"\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-10\",style:{color:\"dimgray\"}},/*#__PURE__*/React.createElement(\"span\",{className:\"item-emph\"},b.description)),_this2.props.userIsMember==0&&/*#__PURE__*/React.createElement(\"div\",{style:{position:\"absolute\",right:\"5px\"},className:\"buy-ellips d-flex align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"buy-ellips-menu\",style:_this2.state.menuIndex===index?{width:\"295px\"}:{width:\"0\"}},_this2.state.removeCheck!==index&&/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm btn-danger m-2\",style:{fontSize:\".7rem\"},onClick:function onClick(ev){ev.stopPropagation();_this2.setState({removeCheck:index});}},\"Remove\"),_this2.state.removeCheck===index&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:\".7rem\"}},\"Are you sure?\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm btn-danger m-2\",style:{fontSize:\".7rem\"},onClick:function onClick(ev){ev.stopPropagation();_this2.props.removeBuy(b.id);}},\"Remove\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm btn-secondary m-2\",style:{fontSize:\".7rem\"},onClick:function onClick(ev){ev.stopPropagation();_this2.setState({removeCheck:null});}},\"Keep Offer\")),_this2.state.removeCheck!==index&&/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm btn-primary m-2\",style:{fontSize:\".7rem\",whiteSpace:\"nowrap\"},onClick:function onClick(ev){ev.stopPropagation();_this2.seeOrder(b);}},\"View Orders\")),/*#__PURE__*/React.createElement(\"i\",{style:{width:\"20px\",textAlign:\"center\",marginLeft:\"5px\",color:_this2.state.menuIndex===index?\"red\":\"gray\"},className:_this2.state.menuIndex===index?\"far fa-times-circle\":\"fas fa-ellipsis-v\",onClick:function onClick(ev){ev.stopPropagation();console.log(index,_this2.state.menuIndex);_this2.setState({menuIndex:index===_this2.state.menuIndex?null:index,removeCheck:null});}}))),/*#__PURE__*/React.createElement(\"div\",{className:index===_this2.state.showBuyOptions?\"buy-options bo-show\":\"buy-options\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\",style:{fontSize:\"x-small\",fontWeight:\"700\"}},/*#__PURE__*/React.createElement(\"div\",null,b.summary),/*#__PURE__*/React.createElement(\"div\",null,\"Deal: \",b.units,\" \",b.unit_measure,\" for $\",b.price)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\",style:{fontSize:\"x-small\",fontWeight:\"700\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},\"Group orders \",_this2.totalUnitsPurchased(b.id),\"/\",b.units,b.unit_measure))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center align-items-center my-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\",style:{justifyContent:\"space-between\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"span\",{className:\"buy-cost\",style:{fontSize:\".7rem\"}},\"Total $\",(b.price/b.units*_this2.state.buyQuantity).toFixed(2)))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4 text-center\"},/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:\".7rem\"}},\"Order in \",b.unit_measure),/*#__PURE__*/React.createElement(\"input\",{className:\"ml-2\",style:{borderStyle:\"none\",borderRadius:\"3px\",width:\"50px\",textAlign:\"center\"},value:_this2.state.buyQuantity,type:\"number\",onChange:function onChange(ev){return _this2.setState({buyQuantity:ev.target.value});}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-right\"},/*#__PURE__*/React.createElement(\"button\",{style:{fontSize:\"x-small\"},className:\"btn btn-sm btn-primary mr-1\",onClick:function onClick(){return _this2.setState({buyQuantity:_this2.state.buyQuantity+1});}},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-plus\"})),/*#__PURE__*/React.createElement(\"button\",{style:{fontSize:\"x-small\"},className:\"btn btn-sm btn-primary\",onClick:function onClick(){return _this2.setState({buyQuantity:_this2.state.buyQuantity>0?_this2.state.buyQuantity-1:0});}},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-minus\"}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col text-center\"},_this2.userHasOrder(_this2.props.userId,b.id)===false?/*#__PURE__*/React.createElement(\"button\",{style:{fontSize:\".7rem\"},className:\"btn btn-sm btn-success\",onClick:function onClick(){_this2.props.placeOrder(b,_this2.state.buyQuantity);_this2.setState({spinner:true});_this2.closeOptions();}},\"Commit\",_this2.state.spinner&&/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border text-info\",role:\"status\",style:{position:\"absolute\",top:\"50%\",left:\"45%\"}},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\"))):/*#__PURE__*/React.createElement(\"button\",{style:{fontSize:\".7rem\"},className:\"btn btn-sm btn-success\",onClick:function onClick(){_this2.props.updateOrder(b,_this2.state.buyQuantity,_this2.userHasOrder(_this2.props.userId,b.id));_this2.setState({spinner:true});_this2.closeOptions();}},\"Update\",_this2.state.spinner&&/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border text-info\",role:\"status\",style:{position:\"absolute\",top:\"50%\",left:\"45%\"}},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\")))))));}))))));}}]);return MyGroupBuys;}(Component);export default MyGroupBuys;","map":{"version":3,"sources":["C:/Users/xmark/Desktop/Code/Servers/FC-SERVER/food-commune/src/components/MyGroupBuys.jsx"],"names":["React","Component","MyGroupOrders","Link","MyGroupBuys","state","menuIndex","removeCheck","viewOrder","showBuyOptions","buyQuantity","spinner","totalUnitsPurchased","dealId","units","props","data","Purchases","forEach","p","deal_id","purchase_units","seeOrder","order","setState","index","buy","find","obj","id","user_id","userId","userHasOrder","closeOptions","setTimeout","font","float","height","overflowY","listStyle","padding","fontSize","Buys","map","b","boxShadow","image_url","color","description","userIsMember","position","right","width","ev","stopPropagation","removeBuy","whiteSpace","textAlign","marginLeft","console","log","fontWeight","summary","unit_measure","price","justifyContent","toFixed","borderStyle","borderRadius","target","value","placeOrder","top","left","updateOrder"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport MyGroupOrders from \"./MyGroupOrders\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nclass MyGroupBuys extends Component {\r\n  state = {\r\n    menuIndex: null,\r\n    removeCheck: null,\r\n    viewOrder: null,\r\n    showBuyOptions: null,\r\n    buyQuantity: 0,\r\n    spinner: false,\r\n  };\r\n\r\n  totalUnitsPurchased = (dealId) => {\r\n    let units = 0;\r\n    this.props.data.Purchases.forEach((p) => {\r\n      if (p.deal_id === dealId) {\r\n        units += p.purchase_units;\r\n      }\r\n    });\r\n\r\n    return units;\r\n  };\r\n\r\n  seeOrder = (order) => {\r\n    this.setState({ viewOrder: order });\r\n  };\r\n\r\n  showBuyOptions = (index, buy) => {\r\n    let order = this.props.data.Purchases.find((obj) => {\r\n      return obj.deal_id === buy.id && obj.user_id === this.props.userId;\r\n    });\r\n\r\n    this.setState({\r\n      showBuyOptions: this.state.showBuyOptions === index ? null : index,\r\n      buyQuantity: order ? order.purchase_units : 0,\r\n    });\r\n  };\r\n\r\n  userHasOrder = (userId, dealId) => {\r\n    // Look for existing order\r\n    let order = this.props.data.Purchases.find((obj) => {\r\n      return obj.deal_id === dealId && obj.user_id === userId;\r\n    });\r\n    return order ? order : false;\r\n  };\r\n\r\n  closeOptions = () => {\r\n    setTimeout(() => {\r\n      this.setState({\r\n        showBuyOptions: null,\r\n        menuIndex: null,\r\n        spinner: false,\r\n        removeCheck: null,\r\n      });\r\n    }, 1500);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        {this.state.viewOrder && (\r\n          <MyGroupOrders\r\n            data={this.props.data}\r\n            Buy={this.state.viewOrder}\r\n            seeOrder={this.seeOrder}\r\n          />\r\n        )}\r\n        {!this.state.viewOrder && (\r\n          <div className=\"card bg-light\">\r\n            <div className=\"card-header button-group\">\r\n              <div>Our Buys - Place Your Order Now!</div>\r\n              <Link\r\n                to=\"/catalog\"\r\n                className=\"btn btn-sm btn-primary\"\r\n                style={{\r\n                  font: \"small-caption\",\r\n                  float: \"right\",\r\n                  height: \"fit-content\",\r\n                }}\r\n              >\r\n                catalog\r\n              </Link>\r\n            </div>\r\n            <div className=\"card-body p-0\" style={{ overflowY: \"auto\" }}>\r\n              <div className=\"container-fluid\" id=\"group-list\">\r\n                <ul\r\n                  id=\"group-buys-list\"\r\n                  style={{ listStyle: \"none\", padding: \"0\", fontSize: \"small\" }}\r\n                >\r\n                  {this.props.data &&\r\n                    this.props.data.Buys.map((b, index) => {\r\n                      return (\r\n                        <React.Fragment>\r\n                          <li\r\n                            key={index}\r\n                            className=\"row group-buy-item\"\r\n                            style={{\r\n                              boxShadow:\r\n                                this.state.showBuyOptions === index\r\n                                  ? \"0px 4px 6px 1px rgba(0, 0, 0, 0.2)\"\r\n                                  : \"none\",\r\n                            }}\r\n                            onClick={() => this.showBuyOptions(index, b)}\r\n                          >\r\n                            {/* Item image */}\r\n                            <div className=\"col-2\">\r\n                              <img\r\n                                className=\"seller-img\"\r\n                                src={\"./Uploads/Deal_Images/\" + b.image_url}\r\n                                alt=\"\"\r\n                              />\r\n                            </div>\r\n                            {/* Item info */}\r\n                            <div\r\n                              className=\"col-10\"\r\n                              style={{ color: \"dimgray\" }}\r\n                            >\r\n                              <span className=\"item-emph\">{b.description}</span>\r\n                            </div>\r\n\r\n                            {this.props.userIsMember == 0 && (\r\n                              <div\r\n                                style={{ position: \"absolute\", right: \"5px\" }}\r\n                                className=\"buy-ellips d-flex align-items-center\"\r\n                              >\r\n                                <div\r\n                                  className=\"buy-ellips-menu\"\r\n                                  style={\r\n                                    this.state.menuIndex === index\r\n                                      ? { width: \"295px\" }\r\n                                      : { width: \"0\" }\r\n                                  }\r\n                                >\r\n                                  {/* Remove */}\r\n                                  {/* step 1 */}\r\n                                  {this.state.removeCheck !== index && (\r\n                                    <button\r\n                                      className=\"btn btn-sm btn-danger m-2\"\r\n                                      style={{ fontSize: \".7rem\" }}\r\n                                      onClick={(ev) => {\r\n                                        ev.stopPropagation();\r\n                                        this.setState({ removeCheck: index });\r\n                                      }}\r\n                                    >\r\n                                      Remove\r\n                                    </button>\r\n                                  )}\r\n                                  {/* step 2 */}\r\n                                  {this.state.removeCheck === index && (\r\n                                    <React.Fragment>\r\n                                      <span style={{ fontSize: \".7rem\" }}>\r\n                                        Are you sure?\r\n                                      </span>\r\n                                      <button\r\n                                        className=\"btn btn-sm btn-danger m-2\"\r\n                                        style={{ fontSize: \".7rem\" }}\r\n                                        onClick={(ev) => {\r\n                                          ev.stopPropagation();\r\n                                          this.props.removeBuy(b.id);\r\n                                        }}\r\n                                      >\r\n                                        Remove\r\n                                      </button>\r\n                                      <button\r\n                                        className=\"btn btn-sm btn-secondary m-2\"\r\n                                        style={{ fontSize: \".7rem\" }}\r\n                                        onClick={(ev) => {\r\n                                          ev.stopPropagation();\r\n                                          this.setState({ removeCheck: null });\r\n                                        }}\r\n                                      >\r\n                                        Keep Offer\r\n                                      </button>\r\n                                    </React.Fragment>\r\n                                  )}\r\n\r\n                                  {this.state.removeCheck !== index && (\r\n                                    <button\r\n                                      className=\"btn btn-sm btn-primary m-2\"\r\n                                      style={{\r\n                                        fontSize: \".7rem\",\r\n                                        whiteSpace: \"nowrap\",\r\n                                      }}\r\n                                      onClick={(ev) => {\r\n                                        ev.stopPropagation();\r\n                                        this.seeOrder(b);\r\n                                      }}\r\n                                    >\r\n                                      View Orders\r\n                                    </button>\r\n                                  )}\r\n                                </div>\r\n\r\n                                <i\r\n                                  style={{\r\n                                    width: \"20px\",\r\n                                    textAlign: \"center\",\r\n                                    marginLeft: \"5px\",\r\n                                    color:\r\n                                      this.state.menuIndex === index\r\n                                        ? \"red\"\r\n                                        : \"gray\",\r\n                                  }}\r\n                                  className={\r\n                                    this.state.menuIndex === index\r\n                                      ? \"far fa-times-circle\"\r\n                                      : \"fas fa-ellipsis-v\"\r\n                                  }\r\n                                  onClick={(ev) => {\r\n                                    ev.stopPropagation();\r\n                                    console.log(index, this.state.menuIndex);\r\n                                    this.setState({\r\n                                      menuIndex:\r\n                                        index === this.state.menuIndex\r\n                                          ? null\r\n                                          : index,\r\n                                      removeCheck: null,\r\n                                    });\r\n                                  }}\r\n                                ></i>\r\n                              </div>\r\n                            )}\r\n                          </li>\r\n\r\n                          {/* Buy Options */}\r\n                          <div\r\n                            className={\r\n                              index === this.state.showBuyOptions\r\n                                ? \"buy-options bo-show\"\r\n                                : \"buy-options\"\r\n                            }\r\n                          >\r\n                            <div className=\"row justify-content-center align-items-center\">\r\n                              <div\r\n                                className=\"col-8\"\r\n                                style={{\r\n                                  fontSize: \"x-small\",\r\n                                  fontWeight: \"700\",\r\n                                }}\r\n                              >\r\n                                <div>{b.summary}</div>\r\n                                <div>\r\n                                  Deal: {b.units} {b.unit_measure} for $\r\n                                  {b.price}\r\n                                </div>\r\n                              </div>\r\n                              <div\r\n                                className=\"col-4\"\r\n                                style={{\r\n                                  fontSize: \"x-small\",\r\n                                  fontWeight: \"700\",\r\n                                }}\r\n                              >\r\n                                <div className=\"text-right\">\r\n                                  Group orders {this.totalUnitsPurchased(b.id)}/\r\n                                  {b.units}\r\n                                  {b.unit_measure}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"row justify-content-center align-items-center my-2\">\r\n                              <div\r\n                                className=\"col-4\"\r\n                                style={{ justifyContent: \"space-between\" }}\r\n                              >\r\n                                <div className=\"text-center\">\r\n                                  <span\r\n                                    className=\"buy-cost\"\r\n                                    style={{ fontSize: \".7rem\" }}\r\n                                  >\r\n                                    Total $\r\n                                    {(\r\n                                      (b.price / b.units) *\r\n                                      this.state.buyQuantity\r\n                                    ).toFixed(2)}\r\n                                  </span>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"col-4 text-center\">\r\n                                <span style={{ fontSize: \".7rem\" }}>\r\n                                  Order in {b.unit_measure}\r\n                                </span>\r\n                                <input\r\n                                  className=\"ml-2\"\r\n                                  style={{\r\n                                    borderStyle: \"none\",\r\n                                    borderRadius: \"3px\",\r\n                                    width: \"50px\",\r\n                                    textAlign: \"center\",\r\n                                  }}\r\n                                  value={this.state.buyQuantity}\r\n                                  type=\"number\"\r\n                                  onChange={(ev) =>\r\n                                    this.setState({\r\n                                      buyQuantity: ev.target.value,\r\n                                    })\r\n                                  }\r\n                                ></input>\r\n                              </div>\r\n                              <div className=\"col-4\">\r\n                                <div className=\"text-right\">\r\n                                  <button\r\n                                    style={{ fontSize: \"x-small\" }}\r\n                                    className=\"btn btn-sm btn-primary mr-1\"\r\n                                    onClick={() =>\r\n                                      this.setState({\r\n                                        buyQuantity: this.state.buyQuantity + 1,\r\n                                      })\r\n                                    }\r\n                                  >\r\n                                    <i className=\"fas fa-plus\"></i>\r\n                                  </button>\r\n                                  <button\r\n                                    style={{ fontSize: \"x-small\" }}\r\n                                    className=\"btn btn-sm btn-primary\"\r\n                                    onClick={() =>\r\n                                      this.setState({\r\n                                        buyQuantity:\r\n                                          this.state.buyQuantity > 0\r\n                                            ? this.state.buyQuantity - 1\r\n                                            : 0,\r\n                                      })\r\n                                    }\r\n                                  >\r\n                                    <i className=\"fas fa-minus\"></i>\r\n                                  </button>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div className=\"row justify-content-center\">\r\n                              <div className=\"col text-center\">\r\n                                {this.userHasOrder(this.props.userId, b.id) ===\r\n                                false ? (\r\n                                  <button\r\n                                    style={{ fontSize: \".7rem\" }}\r\n                                    className=\"btn btn-sm btn-success\"\r\n                                    onClick={() => {\r\n                                      this.props.placeOrder(\r\n                                        b,\r\n                                        this.state.buyQuantity\r\n                                      );\r\n                                      this.setState({ spinner: true });\r\n                                      this.closeOptions();\r\n                                    }}\r\n                                  >\r\n                                    Commit\r\n                                    {/* Spinner */}\r\n                                    {this.state.spinner && (\r\n                                      <div\r\n                                        class=\"spinner-border text-info\"\r\n                                        role=\"status\"\r\n                                        style={{\r\n                                          position: \"absolute\",\r\n                                          top: \"50%\",\r\n                                          left: \"45%\",\r\n                                        }}\r\n                                      >\r\n                                        <span class=\"sr-only\">Loading...</span>\r\n                                      </div>\r\n                                    )}\r\n                                  </button>\r\n                                ) : (\r\n                                  <button\r\n                                    style={{ fontSize: \".7rem\" }}\r\n                                    className=\"btn btn-sm btn-success\"\r\n                                    onClick={() => {\r\n                                      this.props.updateOrder(\r\n                                        b,\r\n                                        this.state.buyQuantity,\r\n                                        this.userHasOrder(\r\n                                          this.props.userId,\r\n                                          b.id\r\n                                        )\r\n                                      );\r\n                                      this.setState({ spinner: true });\r\n                                      this.closeOptions();\r\n                                    }}\r\n                                  >\r\n                                    Update\r\n                                    {/* Spinner */}\r\n                                    {this.state.spinner && (\r\n                                      <div\r\n                                        class=\"spinner-border text-info\"\r\n                                        role=\"status\"\r\n                                        style={{\r\n                                          position: \"absolute\",\r\n                                          top: \"50%\",\r\n                                          left: \"45%\",\r\n                                        }}\r\n                                      >\r\n                                        <span class=\"sr-only\">Loading...</span>\r\n                                      </div>\r\n                                    )}\r\n                                  </button>\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </React.Fragment>\r\n                      );\r\n                    })}\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MyGroupBuys;\r\n"]},"metadata":{},"sourceType":"module"}