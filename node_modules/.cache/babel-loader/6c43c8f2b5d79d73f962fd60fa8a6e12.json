{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import ItemView from'./ItemView';import MyGroupHeader from'./MyGroupHeader';import MyGroupProfile from'./MyGroupProfile';import MyGroupBuys from'./MyGroupBuys';import MyGroupMembers from'./MyGroupMemebers';import MyGroupNews from'./MyGroupNews';import{connect}from\"react-redux\";/**\r\n * Roles: How user views are affected my their ROLE level\r\n *\r\n * Description: state.userIsMember determines the ROLL.\r\n *              userIsMember = 0 is Admin priviledges.\r\n *              userIsMember = 1 is Non-Admin group user. Cannot see admin options.\r\n *              userIsMember > 1 (2 is not a member, but possible requested to join group).\r\n *\r\n *              Currently only using 0, 1, and 2 for ROLES.\r\n */var mapStateToProps=function mapStateToProps(state){return{provisional:state.provisional,user:state.user,token:state.token};};var MyGroupPage=/*#__PURE__*/function(_Component){_inherits(MyGroupPage,_Component);var _super=_createSuper(MyGroupPage);function MyGroupPage(){var _this;_classCallCheck(this,MyGroupPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={modal:null,modalUpdate:null,joinRequested:false,userIsMember:3};_this.itemView=function(deal){var updateBuy=_this.state.data.Purchases.find(function(obj){return obj.user_id===_this.state.user.id&&obj.deal_id===deal.id;});console.log(updateBuy);if(updateBuy){_this.setState({modalUpdate:updateBuy,modal:deal});}else{_this.setState({modal:deal});}};_this.closeModal=function(){_this.setState({modal:null});};_this.sendJoinRequest=function(){joinRequest(_this.state.token,_this.state.user,_this.state.data.Clan[0].id).then(function(resolved){console.log(resolved);_this.setState({joinRequested:true});}).catch(function(err){console.log(err);});};_this.leaveGroup=function(){removeUserFromGroup(_this.state.token,_this.state.user,_this.state.data.Clan[0].id).then(function(resolved){console.log(resolved);_this.setState({userIsMember:false,joinRequested:false});}).catch(function(err){console.log(err);});};_this.memberRequest=function(user_id,memberState){handleMemberRequest(_this.state.token,user_id,_this.state.data.Clan[0].id,memberState).then(function(resolved){console.log(resolved);if(memberState===1){_this.setState(function(prevState){var data=_objectSpread({},prevState.data);var requestIndex=data.JoinRequests.findIndex(function(obj){return obj.id===user_id;});var joinRequest=data.JoinRequests.splice(requestIndex,1);joinRequest[0].user_is_admin=0;data.Members.push(joinRequest[0]);return{data:data};});}else if(memberState===3){}}).catch(function(err){console.log(err);});};_this.makeRevokeAdmin=function(user_id,adminValue){adminToggle(_this.state.token,user_id,_this.state.data.Clan[0].id,adminValue).then(function(resolved){console.log(resolved);_this.setState(function(prevState){var data=_objectSpread({},prevState.data);var memberIndex=data.Members.findIndex(function(obj){return obj.id===user_id;});data.Members[memberIndex].user_is_admin=adminValue;return{data:data};});}).catch(function(err){console.log(err);});};_this.removeMember=function(user_id){deleteMember(_this.state.token,user_id,_this.state.data.Clan[0].id).then(function(resolved){console.log(resolved);_this.setState(function(prevState){var data=_objectSpread({},prevState.data);var memberIndex=data.Members.findIndex(function(obj){return obj.id===user_id;});data.Members.splice(memberIndex,1);return{data:data};});}).catch(function(err){console.log(err);});};_this.updateClan=function(payload){updateClanFields(_this.state.token,_this.state.data.Clan[0].id,payload).then(function(resolved){console.log(resolved);_this.setState(function(prevState){var data=_objectSpread({},prevState.data);var keys=Object.keys(payload);keys.forEach(function(k){data.Clan[0][k]=payload[k];});return{data:data};});}).catch(function(err){console.log(err);});};_this.removeBuy=function(dealId){deleteGroupBuy(_this.state.token,_this.state.data.Clan[0].id,dealId).then(function(resolved){console.log(resolved);console.log(\"BUY ID = \",dealId);_this.setState(function(prevState){var data=_objectSpread({},prevState.data);var buyIndex=data.Buys.findIndex(function(obj){return obj.id===dealId;});console.log(buyIndex);data.Buys.splice(buyIndex,1);return{data:data};});}).catch(function(err){console.log(err);});};_this.addNewNews=function(message){insertNews(_this.state.token,_this.state.data.Clan[0].id,message).then(function(resolved){console.log(resolved);_this.setState(function(prevState){var data=_objectSpread({},prevState.data);data.News.unshift({message:message});return{data:data};});}).catch(function(err){console.log(err);});};return _this;}_createClass(MyGroupPage,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;var params=new URLSearchParams(window.location.search);var ref=params.get(\"ref\");fetchData(this.props.token,this.props.user.id,ref).then(function(resolved){console.log(resolved);_this2.setState({data:resolved});// Is User a Clan member?\nvar user=resolved.Members.find(function(obj){return obj.id===_this2.state.user.id;});if(user){_this2.setState({userIsMember:user.user_is_admin===1?0:1});}else{_this2.setState({userIsMember:2});}// Did User request to join Clan?\nvar joinRequest=resolved.JoinRequests.find(function(obj){if(obj.id===_this2.state.user.id){_this2.setState({joinRequested:true});}});}).catch(function(err){console.log(err);});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{id:\"mygroup-page\",className:\"row row-border justify-content-center mb-4\"},/*#__PURE__*/React.createElement(\"div\",{id:\"main-content\",className:\"col spartan\"},this.state.modal&&/*#__PURE__*/React.createElement(ItemView,{modal:this.state.modal,closeModal:this.closeModal,options:GroupPageActions(this.state.token,this.state.user.id,this.state.data.Clan[0].id,this.state.modal,this.state.modalUpdate)}),/*#__PURE__*/React.createElement(MyGroupHeader,{sendJoinRequest:this.sendJoinRequest,joinRequested:this.state.joinRequested,data:this.state.data,userIsMember:this.state.userIsMember,leaveGroup:this.leaveGroup,updateClan:this.updateClan}),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{id:\"mygroup-profile\",className:\"col-sm-12 col-lg-6 d-flex\"},this.state.data&&/*#__PURE__*/React.createElement(MyGroupProfile,{data:this.state.data,userIsMember:this.state.userIsMember,updateClan:this.updateClan})),/*#__PURE__*/React.createElement(\"div\",{id:\"mygroup-buys\",className:\"col-sm-12 col-lg-6 d-flex\"},/*#__PURE__*/React.createElement(MyGroupBuys,{itemView:this.itemView,data:this.state.data,removeBuy:this.removeBuy,userIsMember:this.state.userIsMember}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-4\"},/*#__PURE__*/React.createElement(\"div\",{id:\"members-card\",className:\"col-sm-12 col-lg-6 d-flex\"},/*#__PURE__*/React.createElement(MyGroupMembers,{data:this.state.data,user:this.state.user,memberRequest:this.memberRequest,userIsMember:this.state.userIsMember,makeRevokeAdmin:this.makeRevokeAdmin,removeMember:this.removeMember})),/*#__PURE__*/React.createElement(\"div\",{id:\"news-card\",className:\"col-sm-12 col-lg-6 d-flex\"},/*#__PURE__*/React.createElement(MyGroupNews,{addNewNews:this.addNewNews,data:this.state.data}))))));}}]);return MyGroupPage;}(Component);export default connect(mapStateToProps)(MyGroupPage);function fetchData(token,userid,ref){console.log(\"fetching data......\",token,userid);return new Promise(function(resolve,reject){var request={userId:userid,clanId:ref};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/clanView\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(!res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function joinRequest(token,user,clanId){console.log(\"fetching data......\");return new Promise(function(resolve,reject){var request={user:user,clanId:clanId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/joinClanRequest\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function removeUserFromGroup(token,user,clanId){console.log(\"fetching data......\");return new Promise(function(resolve,reject){var request={user:user,clanId:clanId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/removeUserFromClan\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function handleMemberRequest(token,user,clanId,memberState){return new Promise(function(resolve,reject){var request={user:user,clanId:clanId,memberState:memberState};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/addUserToGroup\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function adminToggle(token,user,clanId,adminValue){return new Promise(function(resolve,reject){var request={user:user,clanId:clanId,adminValue:adminValue};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/adminToggle\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function deleteMember(token,user,clanId){return new Promise(function(resolve,reject){var request={user:user,clanId:clanId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/deleteMember\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function updateClanFields(token,clanId,payload){return new Promise(function(resolve,reject){var request={values:payload,clanId:clanId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/updateClanFields\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function deleteGroupBuy(token,clanId,dealId){return new Promise(function(resolve,reject){var request={clanId:clanId,dealId:dealId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/deleteGroupBuy\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function insertNews(token,clanId,message){return new Promise(function(resolve,reject){var request={clanId:clanId,message:message};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/insertNews\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}","map":{"version":3,"sources":["C:/Users/xmark/Desktop/Code/Servers/Qumoc/food-commune/src/components/MyGroupPage.jsx"],"names":["React","Component","ItemView","MyGroupHeader","MyGroupProfile","MyGroupBuys","MyGroupMembers","MyGroupNews","connect","mapStateToProps","state","provisional","user","token","MyGroupPage","modal","modalUpdate","joinRequested","userIsMember","itemView","deal","updateBuy","data","Purchases","find","obj","user_id","id","deal_id","console","log","setState","closeModal","sendJoinRequest","joinRequest","Clan","then","resolved","catch","err","leaveGroup","removeUserFromGroup","memberRequest","memberState","handleMemberRequest","prevState","requestIndex","JoinRequests","findIndex","splice","user_is_admin","Members","push","makeRevokeAdmin","adminValue","adminToggle","memberIndex","removeMember","deleteMember","updateClan","payload","updateClanFields","keys","Object","forEach","k","removeBuy","dealId","deleteGroupBuy","buyIndex","Buys","addNewNews","message","insertNews","News","unshift","params","URLSearchParams","window","location","search","ref","get","fetchData","props","GroupPageActions","userid","Promise","resolve","reject","request","userId","clanId","options","method","headers","Headers","Authorization","body","JSON","stringify","entity","fetch","res","json","success","values"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport ItemView from './ItemView';\r\nimport MyGroupHeader from './MyGroupHeader';\r\nimport MyGroupProfile from './MyGroupProfile';\r\nimport MyGroupBuys from './MyGroupBuys';\r\nimport MyGroupMembers from './MyGroupMemebers';\r\nimport MyGroupNews from './MyGroupNews';\r\nimport { connect } from \"react-redux\";\r\n\r\n/**\r\n * Roles: How user views are affected my their ROLE level\r\n *\r\n * Description: state.userIsMember determines the ROLL.\r\n *              userIsMember = 0 is Admin priviledges.\r\n *              userIsMember = 1 is Non-Admin group user. Cannot see admin options.\r\n *              userIsMember > 1 (2 is not a member, but possible requested to join group).\r\n *\r\n *              Currently only using 0, 1, and 2 for ROLES.\r\n */\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    provisional: state.provisional,\r\n    user: state.user,\r\n    token: state.token\r\n  };\r\n};\r\n\r\nclass MyGroupPage extends Component {\r\n  state = {\r\n    modal: null,\r\n    modalUpdate: null,\r\n    joinRequested: false,\r\n    userIsMember: 3\r\n  };\r\n\r\n  componentWillMount() {\r\n    let params = new URLSearchParams(window.location.search);\r\n    let ref = params.get(\"ref\");\r\n\r\n    fetchData(this.props.token, this.props.user.id, ref)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        this.setState({ data: resolved });\r\n\r\n        // Is User a Clan member?\r\n        let user = resolved.Members.find(obj => {\r\n          return obj.id === this.state.user.id;\r\n        });\r\n        if (user) {\r\n          this.setState({ userIsMember: user.user_is_admin === 1 ? 0 : 1 });\r\n        } else {\r\n          this.setState({ userIsMember: 2 });\r\n        }\r\n\r\n        // Did User request to join Clan?\r\n        let joinRequest = resolved.JoinRequests.find(obj => {\r\n          if (obj.id === this.state.user.id) {\r\n            this.setState({ joinRequested: true });\r\n          }\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  itemView = deal => {\r\n    let updateBuy = this.state.data.Purchases.find(obj => {\r\n      return obj.user_id === this.state.user.id && obj.deal_id === deal.id;\r\n    });\r\n    console.log(updateBuy);\r\n    if (updateBuy) {\r\n      this.setState({ modalUpdate: updateBuy, modal: deal });\r\n    } else {\r\n      this.setState({ modal: deal });\r\n    }\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ modal: null });\r\n  };\r\n\r\n  sendJoinRequest = () => {\r\n    joinRequest(this.state.token, this.state.user, this.state.data.Clan[0].id)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        this.setState({ joinRequested: true });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  leaveGroup = () => {\r\n    removeUserFromGroup(\r\n      this.state.token,\r\n      this.state.user,\r\n      this.state.data.Clan[0].id\r\n    )\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        this.setState({ userIsMember: false, joinRequested: false });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  memberRequest = (user_id, memberState) => {\r\n    handleMemberRequest(\r\n      this.state.token,\r\n      user_id,\r\n      this.state.data.Clan[0].id,\r\n      memberState\r\n    )\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        if (memberState === 1) {\r\n          this.setState(prevState => {\r\n            let data = { ...prevState.data };\r\n            let requestIndex = data.JoinRequests.findIndex(obj => {\r\n              return obj.id === user_id;\r\n            });\r\n            let joinRequest = data.JoinRequests.splice(requestIndex, 1);\r\n            joinRequest[0].user_is_admin = 0;\r\n            data.Members.push(joinRequest[0]);\r\n            return { data: data };\r\n          });\r\n        } else if (memberState === 3) {\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  makeRevokeAdmin = (user_id, adminValue) => {\r\n    adminToggle(\r\n      this.state.token,\r\n      user_id,\r\n      this.state.data.Clan[0].id,\r\n      adminValue\r\n    )\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n\r\n        this.setState(prevState => {\r\n          let data = { ...prevState.data };\r\n          let memberIndex = data.Members.findIndex(obj => {\r\n            return obj.id === user_id;\r\n          });\r\n          data.Members[memberIndex].user_is_admin = adminValue;\r\n\r\n          return { data: data };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  removeMember = user_id => {\r\n    deleteMember(this.state.token, user_id, this.state.data.Clan[0].id)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n\r\n        this.setState(prevState => {\r\n          let data = { ...prevState.data };\r\n          let memberIndex = data.Members.findIndex(obj => {\r\n            return obj.id === user_id;\r\n          });\r\n          data.Members.splice(memberIndex, 1);\r\n          return { data: data };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  updateClan = payload => {\r\n    updateClanFields(this.state.token, this.state.data.Clan[0].id, payload)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n\r\n        this.setState(prevState => {\r\n          let data = { ...prevState.data };\r\n          let keys = Object.keys(payload);\r\n          keys.forEach(k => {\r\n            data.Clan[0][k] = payload[k];\r\n          });\r\n\r\n          return { data: data };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  removeBuy = dealId => {\r\n    deleteGroupBuy(this.state.token, this.state.data.Clan[0].id, dealId)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        console.log(\"BUY ID = \", dealId);\r\n        this.setState(prevState => {\r\n          let data = { ...prevState.data };\r\n          let buyIndex = data.Buys.findIndex(obj => {\r\n            return obj.id === dealId;\r\n          });\r\n          console.log(buyIndex);\r\n          data.Buys.splice(buyIndex, 1);\r\n          return { data: data };\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  addNewNews = message => {\r\n    insertNews(this.state.token, this.state.data.Clan[0].id, message)\r\n      .then(resolved => {\r\n        console.log(resolved);\r\n        this.setState((prevState) => {\r\n          let data = { ...prevState.data };\r\n          data.News.unshift({ message: message });\r\n          return { data: data };\r\n        })\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <div\r\n          id=\"mygroup-page\"\r\n          className=\"row row-border justify-content-center mb-4\"\r\n        >\r\n          <div id=\"main-content\" className=\"col spartan\">\r\n            {this.state.modal && (\r\n              <ItemView\r\n                modal={this.state.modal}\r\n                closeModal={this.closeModal}\r\n                options={GroupPageActions(\r\n                  this.state.token,\r\n                  this.state.user.id,\r\n                  this.state.data.Clan[0].id,\r\n                  this.state.modal,\r\n                  this.state.modalUpdate\r\n                )}\r\n              />\r\n            )}\r\n\r\n            <MyGroupHeader\r\n              sendJoinRequest={this.sendJoinRequest}\r\n              joinRequested={this.state.joinRequested}\r\n              data={this.state.data}\r\n              userIsMember={this.state.userIsMember}\r\n              leaveGroup={this.leaveGroup}\r\n              updateClan={this.updateClan}\r\n            />\r\n\r\n            <div className=\"row\">\r\n              <div id=\"mygroup-profile\" className=\"col-sm-12 col-lg-6 d-flex\">\r\n                {this.state.data && (\r\n                  <MyGroupProfile\r\n                    data={this.state.data}\r\n                    userIsMember={this.state.userIsMember}\r\n                    updateClan={this.updateClan}\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              <div id=\"mygroup-buys\" className=\"col-sm-12 col-lg-6 d-flex\">\r\n                <MyGroupBuys\r\n                  itemView={this.itemView}\r\n                  data={this.state.data}\r\n                  removeBuy={this.removeBuy}\r\n                  userIsMember={this.state.userIsMember}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"row mt-4\">\r\n              <div id=\"members-card\" className=\"col-sm-12 col-lg-6 d-flex\">\r\n                <MyGroupMembers\r\n                  data={this.state.data}\r\n                  user={this.state.user}\r\n                  memberRequest={this.memberRequest}\r\n                  userIsMember={this.state.userIsMember}\r\n                  makeRevokeAdmin={this.makeRevokeAdmin}\r\n                  removeMember={this.removeMember}\r\n                />\r\n              </div>\r\n              <div id=\"news-card\" className=\"col-sm-12 col-lg-6 d-flex\">\r\n                <MyGroupNews\r\n                  addNewNews={this.addNewNews}\r\n                  data={this.state.data}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(MyGroupPage);\r\n\r\nfunction fetchData(token, userid, ref) {\r\n  console.log(\"fetching data......\", token, userid);\r\n  return new Promise((resolve, reject) => {\r\n    let request = { userId: userid, clanId: ref };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/clanView\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (!res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction joinRequest(token, user, clanId) {\r\n  console.log(\"fetching data......\");\r\n  return new Promise((resolve, reject) => {\r\n    let request = { user: user, clanId: clanId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/joinClanRequest\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction removeUserFromGroup(token, user, clanId) {\r\n  console.log(\"fetching data......\");\r\n  return new Promise((resolve, reject) => {\r\n    let request = { user: user, clanId: clanId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/removeUserFromClan\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction handleMemberRequest(token, user, clanId, memberState) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { user: user, clanId: clanId, memberState: memberState };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/addUserToGroup\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction adminToggle(token, user, clanId, adminValue) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { user: user, clanId: clanId, adminValue: adminValue };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/adminToggle\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction deleteMember(token, user, clanId) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { user: user, clanId: clanId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/deleteMember\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction updateClanFields(token, clanId, payload) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { values: payload, clanId: clanId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/updateClanFields\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction deleteGroupBuy(token, clanId, dealId) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { clanId: clanId, dealId: dealId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/deleteGroupBuy\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction insertNews(token, clanId, message) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { clanId: clanId, message: message };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/insertNews\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}"]},"metadata":{},"sourceType":"module"}