{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\FC-SERVER\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import SearchBar from\"./SearchBar\";import GroupList from\"./GroupList\";import CreateGroup from\"./CreateGroup\";import{connect}from\"react-redux\";import{withRouter}from\"react-router-dom\";var mapStateToProps=function mapStateToProps(state){return{provisional:state.provisional,user:state.user,token:state.token};};var GroupsView=/*#__PURE__*/function(_Component){_inherits(GroupsView,_Component);var _super=_createSuper(GroupsView);function GroupsView(){var _this;_classCallCheck(this,GroupsView);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={searchInput:\"\",showAddGroup:false};_this.onSearch=function(ev){var value=ev.target.value;_this.setState({searchInput:value});};_this.addGroup=function(toggle){_this.setState({showAddGroup:_this.state.showAddGroup?false:true});};_this.newGroup=function(payload){payload.user_id=_this.props.user.id;insertGroup(_this.props.token,payload).then(function(resolved){console.log(resolved);_this.setState({showAddGroup:false});_this.setState(function(prevState){var Clans=_toConsumableArray(prevState.data.Clans);payload.admin_id=_this.props.user.id;Clans.push(payload);var data=_objectSpread({},prevState.data,{Clans:Clans});return{data:data};});}).catch(function(err){console.log(err);});};return _this;}_createClass(GroupsView,[{key:\"componentDidMount\",value:function componentDidMount(){// Value passed from Router > Link\nif(this.props.history.location.query){var option=this.props.history.location.query.option;// If the option flag exist and is true open add group window\nif(option)this.setState({showAddGroup:true});}}},{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;fetchData(this.props.token,this.props.user.id).then(function(resolved){console.log(resolved);_this2.setState({data:resolved});}).catch(function(err){console.log(err);});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\",style:{backgroundColor:\"white\"}},this.state.showAddGroup&&/*#__PURE__*/React.createElement(CreateGroup,{newGroup:this.newGroup,addGroup:this.addGroup}),/*#__PURE__*/React.createElement(\"div\",{id:\"group-view\",className:\"col-12\"},/*#__PURE__*/React.createElement(SearchBar,{onSearch:this.onSearch,placeHolderVal:\"Search for group or area...\"}),/*#__PURE__*/React.createElement(GroupList,{searchValue:this.state.searchInput,data:this.state.data,addGroup:this.addGroup}))));}}]);return GroupsView;}(Component);export default connect(mapStateToProps)(withRouter(GroupsView));function fetchData(token,userid){console.log(\"fetching data......\",token,userid);return new Promise(function(resolve,reject){var request={userId:userid};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/accounts/groups\",options).then(function(res){return res.json();}).then(function(res){if(!res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}function insertGroup(token,payload){console.log(\"fetching data......\");return new Promise(function(resolve,reject){var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:payload})};fetch(\"/accounts/createGroup\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.success){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}","map":{"version":3,"sources":["C:/Users/xmark/Desktop/Code/Servers/FC-SERVER/food-commune/src/components/GroupsView.jsx"],"names":["React","Component","SearchBar","GroupList","CreateGroup","connect","withRouter","mapStateToProps","state","provisional","user","token","GroupsView","searchInput","showAddGroup","onSearch","ev","value","target","setState","addGroup","toggle","newGroup","payload","user_id","props","id","insertGroup","then","resolved","console","log","prevState","Clans","data","admin_id","push","catch","err","history","location","query","option","fetchData","backgroundColor","userid","Promise","resolve","reject","request","userId","options","method","headers","Headers","Authorization","body","JSON","stringify","entity","fetch","res","json","success"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport SearchBar from \"./SearchBar\";\r\nimport GroupList from \"./GroupList\";\r\nimport CreateGroup from \"./CreateGroup\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"react-router-dom\";\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    provisional: state.provisional,\r\n    user: state.user,\r\n    token: state.token,\r\n  };\r\n};\r\n\r\nclass GroupsView extends Component {\r\n  state = {\r\n    searchInput: \"\",\r\n    showAddGroup: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    // Value passed from Router > Link\r\n    if (this.props.history.location.query) {\r\n      let option = this.props.history.location.query.option;\r\n\r\n      // If the option flag exist and is true open add group window\r\n      if (option) this.setState({ showAddGroup: true });\r\n    }\r\n  }\r\n\r\n  componentWillMount() {\r\n    fetchData(this.props.token, this.props.user.id)\r\n      .then((resolved) => {\r\n        console.log(resolved);\r\n        this.setState({ data: resolved });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  onSearch = (ev) => {\r\n    let value = ev.target.value;\r\n    this.setState({ searchInput: value });\r\n  };\r\n\r\n  addGroup = (toggle) => {\r\n    this.setState({ showAddGroup: this.state.showAddGroup ? false : true });\r\n  };\r\n\r\n  newGroup = (payload) => {\r\n    payload.user_id = this.props.user.id;\r\n\r\n    insertGroup(this.props.token, payload)\r\n      .then((resolved) => {\r\n        console.log(resolved);\r\n        this.setState({ showAddGroup: false });\r\n        this.setState((prevState) => {\r\n          let Clans = [...prevState.data.Clans];\r\n          payload.admin_id = this.props.user.id;\r\n          Clans.push(payload);\r\n          let data = { ...prevState.data, Clans: Clans };\r\n          return { data: data };\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        {/* <!-- Main Content --> */}\r\n        <div className=\"row\" style={{ backgroundColor: \"white\" }}>\r\n          {this.state.showAddGroup && (\r\n            <CreateGroup newGroup={this.newGroup} addGroup={this.addGroup} />\r\n          )}\r\n          <div id=\"group-view\" className=\"col-12\">\r\n            <SearchBar\r\n              onSearch={this.onSearch}\r\n              placeHolderVal={\"Search for group or area...\"}\r\n            />\r\n            <GroupList\r\n              searchValue={this.state.searchInput}\r\n              data={this.state.data}\r\n              addGroup={this.addGroup}\r\n            />\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(withRouter(GroupsView));\r\n\r\nfunction fetchData(token, userid) {\r\n  console.log(\"fetching data......\", token, userid);\r\n  return new Promise((resolve, reject) => {\r\n    let request = { userId: userid };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request,\r\n      }),\r\n    };\r\n    fetch(\"/accounts/groups\", options)\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((res) => {\r\n        if (!res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction insertGroup(token, payload) {\r\n  console.log(\"fetching data......\");\r\n  return new Promise((resolve, reject) => {\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\",\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: payload,\r\n      }),\r\n    };\r\n    fetch(\"/accounts/createGroup\", options)\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((res) => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}