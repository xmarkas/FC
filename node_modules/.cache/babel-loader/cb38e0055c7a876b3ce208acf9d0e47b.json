{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import ItemView from'./ItemView';import SearchBar from'./SearchBar';import Catalog from'./Catalog';import{CatalogActions}from'./ItemViewOption';import{connect}from\"react-redux\";var mapStateToProps=function mapStateToProps(state){return{user:state.user,token:state.token};};var CatalogView=/*#__PURE__*/function(_Component){_inherits(CatalogView,_Component);var _super=_createSuper(CatalogView);function CatalogView(){var _this;_classCallCheck(this,CatalogView);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={searchInput:\"\",modal:null};_this.onSearch=function(ev){var value=ev.target.value;_this.setState({searchInput:value});};_this.itemView=function(itemIndex){console.log(itemIndex);_this.setState({modal:_this.state.data.Deals[itemIndex]});};_this.closeModal=function(){_this.setState({modal:null});};return _this;}_createClass(CatalogView,[{key:\"componentWillMount\",/**\r\n   * Load data for component\r\n   */value:function componentWillMount(){var _this2=this;// Get catalog items\nvar data=getCatalog().then(function(resolved){console.log(\"DATAAA\",resolved);_this2.setState({data:resolved});}).catch(function(err){console.log(err);});// Get user clans\ngetUserClans(this.props.token,this.props.user.id).then(function(resolved){console.log(resolved);_this2.setState({userClans:resolved.MyClans});}).catch(function(err){console.log(err);});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},this.state.modal&&/*#__PURE__*/React.createElement(ItemView,{modal:this.state.modal,closeModal:this.closeModal,options:CatalogActions(this.props.token,this.state.userClans,this.props.user.id,this.state.modal)//modal as Deal\n}),/*#__PURE__*/React.createElement(\"div\",{id:\"catalog\",className:\"col\"},/*#__PURE__*/React.createElement(SearchBar,{onSearch:this.onSearch,placeHolderVal:rndPlaceHolder()}),this.state.data&&/*#__PURE__*/React.createElement(Catalog,{searchValue:this.state.searchInput,itemView:this.itemView,data:this.state.data}))));}}]);return CatalogView;}(Component);export default connect(mapStateToProps)(CatalogView);function rndPlaceHolder(){var time=new Date().getTime();if(time%2===0){return\"What are you looking for?\";}else if(time%3===0){return\"Carrots, Apples, Tomatoes...\";}else{return\"Strawberries, Onions, Broccoli..\";}}function getCatalog(){return new Promise(function(resolve,reject){var options={method:\"GET\"};fetch(\"https://qumoc.com/foodcommune/site/catalog\",options).then(function(res){return res.json();}).then(function(res){if(res){console.log(res);resolve(res);}else{console.log(\"Unable to retrieve data\");reject(\"Did not load\");}});});}function getUserClans(token,userId){return new Promise(function(resolve,reject){var request={userId:userId};var options={method:\"POST\",headers:new Headers({Authorization:\"Bearer \"+token,\"Content-Type\":\"application/json\"}),body:JSON.stringify({entity:request})};fetch(\"/foodcommune/accounts/userClans\",options).then(function(res){return res.json();}).then(function(res){console.log(res);if(res){// Return to account detail and display error message\nresolve(res);}else{reject(\"Unable to retrieve data\");}});});}","map":{"version":3,"sources":["C:/Users/xmark/Desktop/Code/Servers/Qumoc/food-commune/src/components/CatalogView.jsx"],"names":["React","Component","ItemView","SearchBar","Catalog","CatalogActions","connect","mapStateToProps","state","user","token","CatalogView","searchInput","modal","onSearch","ev","value","target","setState","itemView","itemIndex","console","log","data","Deals","closeModal","getCatalog","then","resolved","catch","err","getUserClans","props","id","userClans","MyClans","rndPlaceHolder","time","Date","getTime","Promise","resolve","reject","options","method","fetch","res","json","userId","request","headers","Headers","Authorization","body","JSON","stringify","entity"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport ItemView from './ItemView';\r\nimport SearchBar from './SearchBar';\r\nimport Catalog from './Catalog';\r\nimport { CatalogActions } from './ItemViewOption';\r\nimport { connect } from \"react-redux\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.user,\r\n    token: state.token\r\n  };\r\n};\r\n\r\nclass CatalogView extends Component {\r\n  state = {\r\n    searchInput: \"\",\r\n    modal: null\r\n  };\r\n\r\n  /**\r\n   * Load data for component\r\n   */\r\n  componentWillMount() {\r\n    // Get catalog items\r\n    let data = getCatalog()\r\n      .then(resolved => {\r\n        console.log(\"DATAAA\", resolved);\r\n        this.setState({ data: resolved });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n    \r\n    // Get user clans\r\n    getUserClans(this.props.token, this.props.user.id)\r\n        .then(resolved => {\r\n          console.log(resolved);\r\n          this.setState({ userClans: resolved.MyClans });\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n  }\r\n\r\n  onSearch = ev => {\r\n    let value = ev.target.value;\r\n\r\n    this.setState({ searchInput: value });\r\n  };\r\n\r\n  itemView = itemIndex => {\r\n    console.log(itemIndex);\r\n    this.setState({ modal: this.state.data.Deals[itemIndex] });\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ modal: null });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        {/* <!-- Main Content --> */}\r\n        <div className=\"row\">\r\n          {this.state.modal && (\r\n            <ItemView\r\n              modal={this.state.modal}\r\n              closeModal={this.closeModal}\r\n              options={CatalogActions(this.props.token, this.state.userClans, this.props.user.id, this.state.modal)} //modal as Deal\r\n            />\r\n          )}\r\n          <div id=\"catalog\" className=\"col\">\r\n            <SearchBar\r\n              onSearch={this.onSearch}\r\n              placeHolderVal={rndPlaceHolder()}\r\n            />\r\n            {this.state.data && (\r\n              <Catalog\r\n                searchValue={this.state.searchInput}\r\n                itemView={this.itemView}\r\n                data={this.state.data}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(CatalogView);\r\n\r\nfunction rndPlaceHolder() {\r\n  let time = new Date().getTime();\r\n\r\n  if (time % 2 === 0) {\r\n    return \"What are you looking for?\";\r\n  } else if (time % 3 === 0) {\r\n    return \"Carrots, Apples, Tomatoes...\";\r\n  } else {\r\n    return \"Strawberries, Onions, Broccoli..\";\r\n  }\r\n}\r\n\r\nfunction getCatalog() {\r\n  return new Promise((resolve, reject) => {\r\n    let options = {\r\n      method: \"GET\"\r\n      \r\n    };\r\n    fetch(\"https://qumoc.com/foodcommune/site/catalog\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        if (res) {\r\n          console.log(res);\r\n          resolve(res);\r\n        } else {\r\n          console.log(\"Unable to retrieve data\");\r\n          reject(\"Did not load\");\r\n        }\r\n      });\r\n  });\r\n}\r\n\r\nfunction getUserClans(token, userId) {\r\n  return new Promise((resolve, reject) => {\r\n    let request = { userId: userId };\r\n    let options = {\r\n      method: \"POST\",\r\n      headers: new Headers({\r\n        Authorization: \"Bearer \" + token,\r\n        \"Content-Type\": \"application/json\"\r\n      }),\r\n      body: JSON.stringify({\r\n        entity: request\r\n      })\r\n    };\r\n    fetch(\"/foodcommune/accounts/userClans\", options)\r\n      .then(res => {\r\n        return res.json();\r\n      })\r\n      .then(res => {\r\n        console.log(res);\r\n        if (res) {\r\n          // Return to account detail and display error message\r\n          resolve(res);\r\n        } else {\r\n          reject(\"Unable to retrieve data\");\r\n        }\r\n      });\r\n  });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}