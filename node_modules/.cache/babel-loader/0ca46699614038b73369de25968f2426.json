{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\xmark\\\\Desktop\\\\Code\\\\Servers\\\\Qumoc\\\\food-commune\\\\src\\\\components\\\\Profile.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from \"react-redux\";\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user\n  };\n};\n\nclass Profile extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      edit: false,\n      area: \"_\",\n      imageFile: null,\n      imgUpload: false,\n      imgPreview: null\n    };\n\n    this.stars = userScore => {\n      let score = [];\n\n      for (let s = 0; s < 5; s++) {\n        if (s < userScore) {\n          score.push( /*#__PURE__*/React.createElement(\"i\", {\n            key: s,\n            className: \"fas fa-star sY\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 23,\n              columnNumber: 20\n            }\n          }));\n        } else {\n          score.push( /*#__PURE__*/React.createElement(\"i\", {\n            key: s,\n            className: \"fas fa-star sG\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 25,\n              columnNumber: 20\n            }\n          }));\n        }\n      }\n\n      return score;\n    };\n\n    this.saveProfile = () => {\n      this.setState({\n        edit: false\n      });\n      let payload = {}; // Append area if has value\n\n      if (this.state.area !== \"_\") payload.area = this.state.area; // Append file name and user id to payload\n\n      if (this.state.imageFile) {\n        // let groupName = this.props.data.Clan[0].name.replace(/\\s|\"|'/g, \"\");\n        let file = this.state.imageFile;\n        let formData = new FormData();\n        formData.append(\"file\", file);\n        payload.image_url = `${this.props.user.id}@${file.name}`;\n        payload.image_url = payload.image_url.replace(/\\s|\"|'/g, \"\");\n        console.log(payload); // Send image\n\n        fetch(`/foodcommune/imageUpload/user?userId=${this.props.user.id}`, {\n          body: formData,\n          method: \"POST\"\n        }).then(res => {\n          return res.json();\n        }).then(res => {\n          console.log(res);\n        });\n      }\n\n      if (Object.keys(payload).length !== 0) this.props.updateProfile(payload);\n    };\n\n    this.groupImgUpload = () => {\n      this.setState(prevState => {\n        return {\n          imgUpload: true\n        };\n      }, () => {\n        document.getElementById('image').click();\n      });\n    };\n\n    this.imgPreview = ev => {\n      let file = document.getElementById(\"image\").files[0];\n      this.setState({\n        imageFile: file\n      });\n      let Reader = new FileReader();\n\n      Reader.onloadend = e => {\n        this.setState({\n          imgPreview: e.target.result\n        });\n      };\n\n      Reader.readAsDataURL(file);\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card bg-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-header\",\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, \"Profile\"), !this.state.edit ? /*#__PURE__*/React.createElement(\"div\", {\n      id: \"edit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-pencil-alt\",\n      onClick: () => {\n        this.setState({\n          edit: true\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }\n    })) : /*#__PURE__*/React.createElement(\"button\", {\n      id: \"save\",\n      onClick: this.saveProfile,\n      className: \"btn btn-sm btn-success\",\n      style: {\n        font: \"small-caption\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 15\n      }\n    }, \"save\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"image\",\n      type: \"file\",\n      style: {\n        display: \"none\"\n      },\n      onChange: this.imgPreview,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 text-center d-flex justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }\n    }, this.state.edit && /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-camera-retro fa-3x\",\n      onClick: this.groupImgUpload,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 19\n      }\n    }), !this.state.imgUpload && !this.props.user.image_url && /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-users fa-7x\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 19\n      }\n    }), !this.state.imgUpload && this.props.user.image_url && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"img-wrap-lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: `./Uploads/Profile_Images/${this.props.user.image_url}`,\n      style: {\n        width: \"inherit\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 21\n      }\n    })), this.state.imgUpload && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"img-wrap-lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      id: \"preview\",\n      src: this.state.imgPreview,\n      style: {\n        width: \"inherit\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6 align-self-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 17\n      }\n    }, this.props.user.first_name, \" \", this.props.user.last_name), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 19\n      }\n    }, this.stars(this.props.user.score))))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"user-details\",\n      className: \"row mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }\n    }, \"Your Area\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, this.state.edit ? /*#__PURE__*/React.createElement(\"input\", {\n      id: \"area\",\n      placeholder: \"general location\",\n      onChange: ev => this.setState({\n        area: ev.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }\n    }) : this.props.user.area)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }\n    }, \"Profile Visibility\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }\n    }, this.state.edit ? /*#__PURE__*/React.createElement(\"select\", {\n      id: \"visibility\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 23\n      }\n    }, \"Private\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 23\n      }\n    }, \"Group Only\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: \"2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 23\n      }\n    }, \"Public\")) : \"Groups Only\"))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"user-details\",\n      className: \"row mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }\n    }, \"Transaction Types\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row justify-content-center text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }\n    }, this.props.user.type === 0 ? \"Buyer\" : this.props.user.type === 1 ? \"Seller\" : \"Buyer/Seller\"))))));\n  }\n\n}\n\nexport default connect(mapStateToProps)(Profile);","map":{"version":3,"sources":["C:/Users/xmark/Desktop/Code/Servers/Qumoc/food-commune/src/components/Profile.jsx"],"names":["React","Component","connect","mapStateToProps","state","user","Profile","edit","area","imageFile","imgUpload","imgPreview","stars","userScore","score","s","push","saveProfile","setState","payload","file","formData","FormData","append","image_url","props","id","name","replace","console","log","fetch","body","method","then","res","json","Object","keys","length","updateProfile","groupImgUpload","prevState","document","getElementById","click","ev","files","Reader","FileReader","onloadend","e","target","result","readAsDataURL","render","display","justifyContent","font","width","first_name","last_name","value","type"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from \"react-redux\";\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.user\r\n  };\r\n};\r\n\r\nclass Profile extends Component {\r\n  state = {\r\n    edit: false,\r\n    area: \"_\",\r\n    imageFile: null,\r\n    imgUpload: false,\r\n    imgPreview: null\r\n  };\r\n\r\n  stars = userScore => {\r\n    let score = [];\r\n    for (let s = 0; s < 5; s++) {\r\n      if (s < userScore) {\r\n        score.push(<i key={s} className=\"fas fa-star sY\"></i>);\r\n      } else {\r\n        score.push(<i key={s} className=\"fas fa-star sG\"></i>);\r\n      }\r\n    }\r\n    return score;\r\n  };\r\n\r\n  saveProfile = () => {\r\n    this.setState({ edit: false });\r\n\r\n    let payload = {};\r\n\r\n    // Append area if has value\r\n    if (this.state.area !== \"_\") payload.area = this.state.area;\r\n\r\n    // Append file name and user id to payload\r\n    if (this.state.imageFile) {\r\n      // let groupName = this.props.data.Clan[0].name.replace(/\\s|\"|'/g, \"\");\r\n      let file = this.state.imageFile;\r\n      let formData = new FormData();\r\n      formData.append(\"file\", file);\r\n\r\n      payload.image_url = `${this.props.user.id}@${file.name}`;\r\n      payload.image_url = payload.image_url.replace(/\\s|\"|'/g, \"\");\r\n      console.log(payload);\r\n\r\n      // Send image\r\n      fetch(`/foodcommune/imageUpload/user?userId=${this.props.user.id}`, {\r\n        body: formData,\r\n        method: \"POST\"\r\n      })\r\n        .then(res => {\r\n          return res.json();\r\n        })\r\n        .then(res => {\r\n          console.log(res);\r\n        });\r\n    }\r\n\r\n    if (Object.keys(payload).length !== 0) this.props.updateProfile(payload);\r\n  };\r\n\r\n  groupImgUpload = () => {\r\n    this.setState(\r\n      prevState => {\r\n        return { imgUpload: true };\r\n      },\r\n      () => {\r\n        document.getElementById('image').click();\r\n      }\r\n    );\r\n  };\r\n\r\n  imgPreview = ev => {\r\n    let file = document.getElementById(\"image\").files[0];\r\n    this.setState({ imageFile: file });\r\n    let Reader = new FileReader();\r\n\r\n    Reader.onloadend = (e) => {\r\n      this.setState({imgPreview: e.target.result})\r\n    };\r\n\r\n    Reader.readAsDataURL(file);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"card bg-light\">\r\n          <div\r\n            className=\"card-header\"\r\n            style={{ display: \"flex\", justifyContent: \"space-between\" }}\r\n          >\r\n            <div>Profile</div>\r\n            {!this.state.edit ? (\r\n              <div id=\"edit\">\r\n                <i\r\n                  className=\"fas fa-pencil-alt\"\r\n                  onClick={() => {\r\n                    this.setState({ edit: true });\r\n                  }}\r\n                ></i>\r\n              </div>\r\n            ) : (\r\n              <button\r\n                id=\"save\"\r\n                onClick={this.saveProfile}\r\n                className=\"btn btn-sm btn-success\"\r\n                style={{ font: \"small-caption\" }}\r\n              >\r\n                save\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div className=\"card-body\">\r\n            {/* ROW */}\r\n            <div className=\"row\">\r\n              <input\r\n                id=\"image\"\r\n                type=\"file\"\r\n                style={{ display: \"none\" }}\r\n                onChange={this.imgPreview}\r\n              ></input>\r\n              <div className=\"col-6 text-center d-flex justify-content-center\">\r\n                {this.state.edit && (\r\n                  <i\r\n                    className=\"fas fa-camera-retro fa-3x\"\r\n                    onClick={this.groupImgUpload}\r\n                  ></i>\r\n                )}\r\n                {!this.state.imgUpload && !this.props.user.image_url && (\r\n                  <i className=\"fas fa-users fa-7x\"></i>\r\n                )}\r\n                {!this.state.imgUpload && this.props.user.image_url && (\r\n                  <div className=\"img-wrap-lg\">\r\n                    <img\r\n                      src={`./Uploads/Profile_Images/${this.props.user.image_url}`}\r\n                      style={{ width: \"inherit\" }}\r\n                    ></img>\r\n                  </div>\r\n                )}\r\n                {this.state.imgUpload && (\r\n                  <div className=\"img-wrap-lg\">\r\n                    <img id=\"preview\" src={this.state.imgPreview} style={{ width: \"inherit\" }}></img>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"col-6 align-self-center\">\r\n                <div className=\"row justify-content-center\">\r\n                  {this.props.user.first_name} {this.props.user.last_name}\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col text-center\">\r\n                    {this.stars(this.props.user.score)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* ROW */}\r\n            <div id=\"user-details\" className=\"row mt-4\">\r\n              <div className=\"col-6\">\r\n                <div className=\"row justify-content-center\">Your Area</div>\r\n                <div className=\"row justify-content-center text-muted\">\r\n                  {this.state.edit ? (\r\n                    <input\r\n                      id=\"area\"\r\n                      placeholder=\"general location\"\r\n                      onChange={ev => this.setState({ area: ev.target.value })}\r\n                    ></input>\r\n                  ) : (\r\n                    this.props.user.area\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"col-6\">\r\n                <div className=\"row justify-content-center\">\r\n                  Profile Visibility\r\n                </div>\r\n                <div className=\"row justify-content-center text-muted\">\r\n                  {this.state.edit ? (\r\n                    <select id=\"visibility\">\r\n                      <option value=\"0\">Private</option>\r\n                      <option value=\"1\">Group Only</option>\r\n                      <option value=\"2\">Public</option>\r\n                    </select>\r\n                  ) : (\r\n                    \"Groups Only\"\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* ROW */}\r\n            <div id=\"user-details\" className=\"row mt-2\">\r\n              <div className=\"col-6\">\r\n                <div className=\"row justify-content-center\">\r\n                  Transaction Types\r\n                </div>\r\n                <div className=\"row justify-content-center text-muted\">\r\n                  {this.props.user.type === 0\r\n                    ? \"Buyer\"\r\n                    : this.props.user.type === 1\r\n                    ? \"Seller\"\r\n                    : \"Buyer/Seller\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Profile);\r\n"]},"metadata":{},"sourceType":"module"}